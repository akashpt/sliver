<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sliver Strip Detection</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="stylesheet" href="../static/css/all.min.css" />
    <link rel="stylesheet" href="../static/css/style.css" />
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <div class="logo-icon">
        <a href="index.html">
          <img src="../static/img/logo/logo.png" alt="" />
        </a>
      </div>
      <div class="brand">
        <div class="brand-name">Sliver Strip Detection</div>
        <div class="brand-sub">Industrial Vision System</div>
      </div>

      <div class="header-pills">
        <div class="pill">
          <span
            class="pill-dot"
            id="jobColorDot"
            style="background: #16a34a"
          ></span>
          <span class="pill-lbl">JOB ID</span>
          <span class="pill-val" id="jobIdLabel">white</span>
        </div>
        <div class="pill">
          <span class="pill-dot live" id="statusDot"></span>
          <span class="pill-lbl">STATUS</span>
          <span class="pill-val" id="statusLabel">STANDBY</span>
        </div>
        <div class="pill">
          <span class="pill-lbl">DEFECTS</span>
          <span class="pill-val" id="hdrDefects">0</span>
        </div>
        <div class="pill">
          <span class="pill-lbl">ACCURACY</span>
          <span class="pill-val">98.4%</span>
        </div>
      </div>

      <div class="hdr-clock" id="clock">--:--:--</div>
    </header>

    <!-- LAYOUT -->
    <div class="container">
      <!-- LEFT SIDEBAR -->
      <aside class="">
        <div class="sec-lbl">Menu</div>
        <a href="index.html" class="nav-btn active">
          <i class="fa-solid fa-gauge"></i> Dashboard
        </a>
        <a href="report.html" class="nav-btn">
          <i class="fas fa-file-lines"></i> Report
        </a>
        <button
          class="nav-btn"
          onclick="showToast('Controller panel opening...', 3000)"
        >
          <i class="fas fa-sliders"></i> Controller
        </button>
        <!-- <button class="nav-btn" onclick="startTraining()">
        <i class="fas fa-graduation-cap"></i> Training
      </button> -->

        <a href="traning.html" class="nav-btn">
          <i class="fas fa-graduation-cap"></i> Training
        </a>
        <button class="nav-btn" onclick="openSettings()">
          <i class="fas fa-gear"></i> Settings
        </button>
        <div class="metrics-row">
          <div class="metric">
            <div class="m-label">Inspected</div>
            <div class="m-val" id="inspectedCount">0</div>
            <!-- <div class="m-note">units today</div> -->
          </div>
          <div class="metric">
            <div class="m-label">Good</div>
            <div class="m-val good" id="goodCount">0</div>
            <!-- <div class="m-note">passed</div> -->
          </div>
          <div class="metric">
            <div class="m-label">Defective</div>
            <div class="m-val bad" id="badCount">0</div>
            <!-- <div class="m-note">rejected</div> -->
          </div>
          <div class="metric">
            <div class="m-label">Uptime</div>
            <div class="m-val" id="uptimeVal">0:00</div>
            <!-- <div class="m-note">this session</div> -->
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <main>
        <div class="feed-bar">
          <div class="feed-title">
            <i class="fas fa-video"></i> Live Camera Feed
          </div>
          <div class="badge-row">
            <span class="badge">HD · 1080P</span>
            <span class="badge live-badge" id="liveBadge">
              <i class="fas fa-circle" style="font-size: 0.42rem"></i> LIVE
            </span>
            <span class="badge">30 FPS</span>
          </div>
        </div>

        <div class="camera-wrap">
          <div class="cm tl"></div>
          <div class="cm tr"></div>
          <div class="cm bl"></div>
          <div class="cm br"></div>

          <div class="no-feed" id="noFeed">
            <i class="fas fa-video-slash"></i>
            <p>NO ACTIVE FEED</p>
            <span>Press START to begin detection</span>
          </div>
          <video
            id="videoFeed"
            autoplay
            playsinline
            muted
            style="
              display: none;
              max-width: 100%;
              max-height: 100%;
              object-fit: contain;
            "
          ></video>
        </div>

        <!-- DEFECTS CAROUSEL / SLIDER (below camera-wrap) -->

        <!-- DEFECT DETAIL MODAL with slider -->
        <div id="defectModal" class="modal">
          <div
            class="modal-box"
            style="width: 86%; max-width: 980px; position: relative"
          >
            <div class="modal-head">
              <i class="fas fa-bug"></i>
              <div class="modal-head-title">Defect Viewer</div>
              <div
                style="margin-left: auto; font-size: 0.9rem; opacity: 0.8"
                id="defectModalPosition"
              ></div>
            </div>

            <div
              class="modal-body"
              style="
                padding: 1rem;
                text-align: center;
                background: #0a0a0a;
                position: relative;
                min-height: 60vh;
                display: flex;
                align-items: center;
                justify-content: center;
              "
            >
              <!-- Navigation Arrows -->
              <button
                id="prevDefect"
                class="defect-nav prev"
                onclick="changeDefect(-1)"
              >
                <i class="fas fa-chevron-left"></i>
              </button>

              <img
                id="defectModalImage"
                style="
                  max-width: 100%;
                  max-height: 68vh;
                  border-radius: 8px;
                  box-shadow: 0 6px 24px rgba(0, 0, 0, 0.7);
                  object-fit: contain;
                "
              />

              <button
                id="nextDefect"
                class="defect-nav next"
                onclick="changeDefect(1)"
              >
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>

            <div
              class="modal-foot"
              style="justify-content: center; padding: 1rem 1.5rem"
            >
              <button class="btn-m primary" onclick="downloadDefectImage()">
                <i class="fas fa-download"></i> Save Current Image
              </button>
              <button class="btn-m delete">
                <i class="fa-regular fa-trash-can"></i> Delete
              </button>
              <button class="btn-m ghost" onclick="closeDefectModal()">
                Close
              </button>
            </div>
          </div>
        </div>
      </main>

      <!-- RIGHT SIDEBAR -->
      <aside class="right">
        <div class="sec-lbl">Controls</div>
        <div class="start_stop_flex">
          <div class="start_name_flex">
            <button
              class="btn-start"
              id="cameraSelect"
              onclick="startDetection()"
            >
              <i class="fas fa-play"></i>
            </button>
            <p>start</p>
          </div>
          <div class="start_name_flex">
            <button class="btn-stop" onclick="stopDetection()">
              <i class="fas fa-stop"></i>
            </button>
            <p>stop</p>
          </div>
        </div>

        <div class="divider mtb-3"></div>
        <div class="defects-section">
          <div class="feed-bar" style="margin-bottom: 0.6rem">
            <div class="sec-lbl">Defected Images</div>
            <!-- <div class="badge">Last 10 detections</div> -->
          </div>

          <div style="position: relative">
            <!-- <button class="slider-arrow prev" onclick="scrollSlider(-156)"><i class="fa-solid fa-angle-left"></i></button> -->

            <div class="defects-slider" id="defectsSlider">
              <!-- thumbs here -->
            </div>

            <!-- <button class="slider-arrow next" onclick="scrollSlider(156)"><i class="fa-solid fa-angle-right"></i></button> -->
          </div>
        </div>
        <!-- <div class="divider"></div> -->
        <!-- <div class="sec-lbl">Detection Stats</div> -->

        <!-- <div class="stat-card">
        <div class="sc-lbl">Confidence</div>
        <div class="sc-val" id="confVal">—</div>
        <div class="pbar">
          <div class="pbar-fill green" id="confBar" style="width:0%"></div>
        </div>
      </div>

      <div class="stat-card">
        <div class="sc-lbl">Defect Rate</div>
        <div class="sc-val" id="defectRateVal">0.0%</div>
        <div class="pbar">
          <div class="pbar-fill" id="defectBar" style="width:0%"></div>
        </div>
      </div> -->
      </aside>
    </div>

    <!-- TOAST -->
    <div id="toast" class="toast"><span id="toastMessage"></span></div>

    <!-- SETTINGS MODAL -->
    <div id="settingsModal" class="modal">
      <div class="modal-box">
        <div class="modal-head">
          <i class="fas fa-gear"></i>
          <div class="modal-head-title">Detection Settings</div>
        </div>
        <div class="modal-body">
          <!-- Tabs -->
          <div class="modal-tabs">
            <button class="modal-tab active" onclick="switchTab('detection')">
              Detection Mode
            </button>
            <button class="modal-tab" onclick="switchTab('threshold')">
              Threshold
            </button>
          </div>

          <!-- Detection Mode Tab Content -->
          <div id="detectionTab" class="tab-content active">
            <span class="sel-lbl" style="display: block; margin-bottom: 8px"
              >Detection Mode</span
            >

            <div class="mode-toggle">
              <input
                type="radio"
                name="mode"
                id="modeDefault"
                value="default"
                checked
                onchange="toggleManual()"
              />
              <label for="modeDefault">Default</label>
              <input
                type="radio"
                name="mode"
                id="modeManual"
                value="manual"
                onchange="toggleManual()"
              />
              <label for="modeManual">Manual</label>
            </div>
            <div id="defaultInfo" style="margin: 12px 0 4px">
              <input
                type="text"
                id="currentModeDisplay"
                value="6.3.1"
                readonly
                style="
                  width: 100%;
                  padding: 11px 14px;
                  font-size: 0.95rem;
                  font-weight: 500;
                  border: 1px solid rgba(90, 25, 31, 0.25);
                  border-radius: 8px;
                  background: #fefefe;
                  color: var(--primary);
                  cursor: default;
                  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.03);
                "
              />

              <p
                style="
                  font-size: 0.74rem;
                  color: var(--gray-500);
                  margin-top: 10px;
                  text-align: center;
                "
              >
                Mode is locked to Default in current system configuration
              </p>
            </div>
            <div id="manualControls" style="display: none">
              <div class="slider-block">
                <div class="slider-row">
                  <div class="slider-top">
                    <span class="slider-name">Exposure</span>
                    <input
                      type="number"
                      id="lowerValue"
                      class="slider-num"
                      value="35"
                      min="0"
                      max="100"
                      oninput="
                        document.getElementById('lowerSlider').value =
                          this.value
                      "
                    />
                  </div>
                  <input
                    type="range"
                    id="lowerSlider"
                    min="0"
                    max="100"
                    value="35"
                    oninput="
                      document.getElementById('lowerValue').value = this.value
                    "
                  />
                </div>
                <!-- <div class="slider-row">
                <div class="slider-top">
                  <span class="slider-name">Upper Threshold</span>
                  <input type="number" id="upperValue" class="slider-num" value="75" min="0" max="100"
                    oninput="document.getElementById('upperSlider').value=this.value">
                </div>
                <input type="range" id="upperSlider" min="0" max="100" value="75"
                  oninput="document.getElementById('upperValue').value=this.value">
              </div> -->
              </div>
            </div>
          </div>

          <!-- Threshold Tab Content -->
          <div id="thresholdTab" class="tab-content">
            <!-- <span class="sel-lbl" style="display:block;margin-bottom:8px;">Threshold Type</span>
          <select id="thresholdType" class="cam-select" style="margin-bottom: 16px;">
            <option value="sensitivity">Sensitivity Level</option>
            <option value="confidence">Confidence Score</option>
            <option value="custom">Custom Range</option>
          </select> -->

            <span class="sel-lbl" style="display: block; margin-bottom: 8px"
              >Threshold Value</span
            >
            <input
              type="number"
              id="thresholdValue"
              placeholder="Enter threshold value"
              style="
                width: 100%;
                padding: 11px 14px;
                font-size: 0.95rem;
                font-weight: 500;
                border: 1px solid rgba(90, 25, 31, 0.25);
                border-radius: 8px;
                background: #ffffff;
                color: var(--primary);
                box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.03);
              "
              value="75"
              min="0"
              max="100"
            />

            <p
              style="
                font-size: 0.74rem;
                color: var(--gray-500);
                margin-top: 10px;
              "
            >
              Adjust threshold value to control detection sensitivity. Higher
              values require more confidence.
            </p>
          </div>
        </div>
        <div class="modal-foot">
          <button class="btn-m ghost" onclick="closeSettings()">Cancel</button>
          <button class="btn-m primary" onclick="saveSettings()">
            Save Settings
          </button>
        </div>
      </div>
    </div>

    <!-- TRAINING MODAL -->
    <div id="trainingModal" class="modal">
      <div class="modal-box">
        <div class="done-body">
          <div class="done-icon"><i class="fas fa-check"></i></div>
          <div class="done-title">Training Complete</div>
          <div class="done-sub">
            Model trained successfully. Detection accuracy updated.
          </div>
        </div>
        <div
          class="modal-foot"
          style="justify-content: center; border-top: 1px solid var(--gray-100)"
        >
          <button
            class="btn-m primary"
            onclick="
              document.getElementById('trainingModal').style.display = 'none'
            "
          >
            Done
          </button>
        </div>
      </div>
    </div>

    <script src="../static/script/index.js"></script>
  </body>
</html>
